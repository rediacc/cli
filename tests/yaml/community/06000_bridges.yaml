name: BRIDGES_TEST
description: Test bridge creation, renaming, and operations
executor: rediacc-cli.py
setup:
- name: create_test_company
  command:
  - CreateNewCompany
  args:
    companyName: BridgesCompany-${TIMESTAMP}
    email: bridges-admin-${TIMESTAMP}@test.com
    password: ${config.test_data.company.admin_password}
  expect:
    success: true
- name: activate_user_account
  command:
  - ActivateUserAccount
  args:
    email: bridges-admin-${TIMESTAMP}@test.com
    activationCode: ${config.test_environment.activation_code}
    password: ${config.test_data.company.admin_password}
  expect:
    success: true
- name: login_as_admin
  command:
  - CreateAuthenticationRequest
  args:
    email: bridges-admin-${TIMESTAMP}@test.com
    password: ${config.test_data.company.admin_password}
  expect:
    success: true
tests:
- name: create_region_for_bridge
  command:
  - CreateRegion
  args:
    regionName: BridgeTestRegion-${TIMESTAMP}_${TEST_ID}
    regionVault: '{"provider": "aws", "zone": "us-west-2"}'
  expect:
    success: true
- name: create_bridge
  command:
  - CreateBridge
  args:
    regionName: BridgeTestRegion-${TIMESTAMP}_${TEST_ID}
    bridgeName: ${config.test_data.bridge.name_pattern}
    bridgeVault: '{"batch_size": "5", "timeout": "300"}'
  expect:
    success: true
- name: update_bridge_name
  command:
  - UpdateBridgeName
  args:
    regionName: BridgeTestRegion-${TIMESTAMP}_${TEST_ID}
    currentBridgeName: ${config.test_data.bridge.name_pattern}
    newBridgeName: Updated-${config.test_data.bridge.name_pattern}
  expect:
    success: true
- name: list_region_bridges
  command:
  - GetRegionBridges
  args:
    regionName: BridgeTestRegion-${TIMESTAMP}_${TEST_ID}
  expect:
    success: true
    output_contains:
    - Updated-${config.test_data.bridge.name_pattern}
- name: verify_cleanup_context
  command:
  - GetUserCompany
  expect:
    success: true
  description: Verify we're still authenticated before logout
- name: logout
  command:
  - DeleteUserRequest
  expect:
    success: true
  description: Logout and invalidate authentication token
