name: "TEAM_MANAGEMENT_TEST"
description: "Test team creation, update, and management operations"
executor: "rediacc-cli.py"

# Export team data for use in other tests
chain_export:
  team_name: "${config.test_data.team.name_pattern}_updated"
  team_vault_version: 3

tests:
  - name: "create_team_with_vault"
    command: ["create", "team", "${config.test_data.team.name_pattern}"]
    args:
      vault: '{"test_key": "test_value", "version": 1}'
    expect:
      success: true
  
  - name: "list_teams"
    command: ["list", "teams"]
    expect:
      success: true
  
  - name: "update_team_name"
    command: ["update", "team", "${config.test_data.team.name_pattern}", "${config.test_data.team.name_pattern}_updated"]
    expect:
      success: true
  
  - name: "update_team_vault"
    command: ["update", "team", "${config.test_data.team.name_pattern}_updated", "${config.test_data.team.name_pattern}_updated"]
    args:
      vault: '{"team_updated": true, "config": {"features": ["backup", "restore"]}}'
      vault_version: 2
    expect:
      success: true
  
  - name: "vault_set_team"
    command: ["vault", "set", "team", "${config.test_data.team.name_pattern}_updated", "-"]
    args:
      vault_version: 3
    stdin: '{"updated_key": "updated_value", "version": 3, "metadata": {"last_updated": "2024-01-01"}}'
    expect:
      success: true
  
  - name: "verify_team_exists_in_list"
    command: ["list", "teams"]
    expect:
      success: true