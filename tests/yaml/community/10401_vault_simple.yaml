name: VAULT_SIMPLE_TEST
description: Simplified test for vault update endpoints
executor: "commands/cli.py"
setup:
- name: create_test_company
  command:
  - CreateNewCompany
  args:
    companyName: VaultSimpleCompany-${TIMESTAMP}
    email: vaultsimple-admin-${TIMESTAMP}@test.com
    password: ${config.test_data.company.admin_password}
  expect:
    success: true
- name: activate_user_account
  command:
  - ActivateUserAccount
  args:
    email: vaultsimple-admin-${TIMESTAMP}@test.com
    activationCode: ${config.test_environment.activation_code}
    password: ${config.test_data.company.admin_password}
  expect:
    success: true
- name: login_as_admin
  command:
  - CreateAuthenticationRequest
  args:
    email: vaultsimple-admin-${TIMESTAMP}@test.com
    password: ${config.test_data.company.admin_password}
  expect:
    success: true
tests:
- name: update_company_vault
  command:
  - UpdateCompanyVault
  args:
    companyVault: '{"TEST_KEY": "test_value", "TIMESTAMP": "${TIMESTAMP}"}'
    vaultVersion: 1
  expect:
    success: true
- name: verify_company_vault
  command:
  - GetCompanyVault
  expect:
    success: true
    output_contains: test_value
- name: create_vault_team
  command:
  - CreateTeam
  args:
    teamName: VaultTeam-${TIMESTAMP}
    teamVault: '{"initial": "data"}'
  expect:
    success: true
- name: update_team_vault
  command:
  - UpdateTeamVault
  args:
    teamName: VaultTeam-${TIMESTAMP}
    teamVault: '{"updated": "true", "timestamp": "${TIMESTAMP}"}'
    vaultVersion: 1
  expect:
    success: true
- name: create_vault_region
  command:
  - CreateRegion
  args:
    regionName: VaultRegion-${TIMESTAMP}
    regionVault: '{"initial": "data"}'
  expect:
    success: true
- name: update_region_vault
  command:
  - UpdateRegionVault
  args:
    regionName: VaultRegion-${TIMESTAMP}
    regionVault: '{"provider": "updated", "timestamp": "${TIMESTAMP}"}'
    vaultVersion: 1
  expect:
    success: true
- name: delete_vault_region
  command:
  - DeleteRegion
  args:
    regionName: VaultRegion-${TIMESTAMP}
  expect:
    success: true
- name: delete_vault_team
  command:
  - DeleteTeam
  args:
    teamName: VaultTeam-${TIMESTAMP}
  expect:
    success: true
- name: verify_cleanup_context
  command:
  - GetUserCompany
  expect:
    success: true
  description: Verify we're still authenticated before logout
- name: logout
  command:
  - DeleteUserRequest
  expect:
    success: true
  description: Logout and invalidate authentication token
